$(document).ready(function(){function e(e=l.LIGHT){let o=e;e===l.SYSTEM&&(o=t()),$("html").attr("data-theme",o),n("theme",e,7),n("system_theme",o,1)}function t(){return window.matchMedia("(prefers-color-scheme: dark)").matches?l.DARK:l.LIGHT}function n(e,t,n){const o=new Date;o.setTime(o.getTime()+24*n*60*60*1e3),document.cookie=`${e}=${t}; expires=${o.toUTCString()}; path=/`}function o(e){$(".theme-toggle button").removeClass("active"),e.addClass("active")}function s(){const e=i("theme")||l.LIGHT;let t;t=e===l.LIGHT?$('.theme-toggle button[title="æµ…è‰²æ¨¡å¼"]'):e===l.DARK?$('.theme-toggle button[title="æ·±è‰²æ¨¡å¼"]'):e===l.SYSTEM?$('.theme-toggle button[title="è·Ÿéšç³»ç»Ÿ"]'):$('.theme-toggle button[title="æµ…è‰²æ¨¡å¼"]'),o(t)}function i(e){const t=document.cookie.split(";");for(let n of t){const[t,o]=n.trim().split("=");if(t===e)return o}return null}function a(e,t,n){const o="wechat-qrcode"===t?"zdyqr-qrcode":"wechat-qrcode";$(document).on("click",e,function(){const e=$(`.${t}`),s=$(`.${o}`),i=$(".share-box");if(e.length)e.remove();else{s.remove();const e=decodeURIComponent(_ARTICLE_URL),o=`\n        <div class="${t} text-center my-4">\n          <img src="${f(e)}" \n               alt="åˆ†äº«äºŒç»´ç "\n               title="${encodeURIComponent(_ARTICLE_NAME)}">\n          <div class="mt-2">${n}</div>\n        </div>\n      `;i.append(o)}})}function c(e,t){$(e).each(function(e){var n=e*t+"s";$(this).css("animation-delay",n)})}const r=(e,t)=>{let n=null;return function(){n||(n=setTimeout(()=>{e.apply(this,arguments),n=null},t))}};$("#nav-backtop").click(function(){return $("html, body").animate({scrollTop:0},200),!1});const l={LIGHT:"light",DARK:"dark",SYSTEM:"system"};$(".theme-toggle").on("click","button",function(){const t=$(this).attr("title");switch(t){case"æµ…è‰²æ¨¡å¼":e(l.LIGHT);break;case"æ·±è‰²æ¨¡å¼":e(l.DARK);break;case"è·Ÿéšç³»ç»Ÿ":e(l.SYSTEM)}o($(this))}),s(),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",()=>{e(l.SYSTEM)});const d=()=>{const e=$(window).scrollTop(),t=$(document).height(),n=$(window).height(),o=Math.round(e/(t-n)*100);o>0?($("#nav-backtop").toggleClass("top-to-active",o>=90),$(".back-to-top").show(),$("#nav-backtop>.top-to-text").text(o>=90?"å›åˆ°é¡¶éƒ¨":o)):$(".back-to-top").hide()};let m=!1;$("#navbar").hasClass("nav-ui-one")&&(m=!0),toggleNavOnScroll=((e,t,n,o=100)=>{if(m)return;const s=$(e),i=$(this).scrollTop();i>o?s.hasClass(n)&&s.removeClass(n).addClass(t):s.hasClass(t)&&s.removeClass(t).addClass(n)}),d(),toggleNavOnScroll("#navbar","nav-ui-one","nav-ui-two",100),$(window).scroll(function(){r(d(),100),r(toggleNavOnScroll("#navbar","nav-ui-one","nav-ui-two",50),100)});let p=0,v=0,u=!1;$("#menu-line").click(function(e){e.stopPropagation();const t=$("#nav-components");if(t.length)return void h();const n=$("#mobile-nav");n.append('<div id="mobile-nav-bg" class="pop-tool-overlay-bg"></div>');const o=$(".nav-inner > ul").clone();o.find(".sub-menu").addClass("mt-1"),o.find(".sub-menu>ul").addClass("row p-1 ml-2"),o.find(".sub-menu>ul>li").addClass("col-4 p-1"),o.find(".nav-item").addClass("pb-3"),o.find(".nav-item>.nav-a").addClass("font-weight-bold"),o.find(".nav-item>.nav-a").prepend('<i class="iconfont icon-xingqiu font-weight-normal mr-1"></i>'),n.append(`<div id="nav-components" class="mobile-aside px-3 py-2"><div class="mx-auto"><i class="back-box mb-2"></i></div><div id="mobile-close-btn" class="mobile-close-btn m-2"><i class="iconfont icon-guanbi"></i></div>${o.prop("outerHTML")}</div>`),requestAnimationFrame(()=>{$("#mobile-nav-bg").css({opacity:"1",visibility:"visible",transform:"rotate(0) scale(1)"}),$("#nav-components").addClass("open")}),$("body").css("overflow","hidden")}),$(document).click(function(e){!$("#nav-components").hasClass("open")||$(e.target).closest("#nav-components").length||$(e.target).closest("#menu-line").length||h()}),$("#nav-components").click(function(e){e.stopPropagation()}),$(document).on("touchstart",function(e){$("#nav-components").hasClass("open")&&(p=e.originalEvent.touches[0].pageY,v=p,u=!0)}),$(document).on("touchmove",function(e){if(u){v=e.originalEvent.touches[0].pageY;const t=v-p;t>0&&$("#nav-components").css("transform",`translateY(${t}px)`)}}),$(document).on("touchend",function(){if(u){const e=v-p,t=$("#nav-components").height()/2;e>t?h():$("#nav-components").css("transform",""),u=!1}}),$(document).on("click","#mobile-close-btn",function(){h()});const h=()=>{const e=$("#nav-components"),t=$("#mobile-nav-bg");e.removeClass("open"),t.css({opacity:0,visibility:"hidden"}),e.one("transitionend",function(){e.remove(),t.remove(),$("body").css("overflow","")})};$("#search-btn").click(function(){$(".main-search").addClass("open"),$("body").css("overflow","hidden")}),$(".search-box").on("click","#search-close-btn",function(){$(".main-search").removeClass("open"),$("body").css("overflow","")});const f=(e,t=200)=>{const n=document.createElement("div");$(n).qrcode({text:e,width:t,height:t});const o=n.querySelector("canvas");if(!o)return console.error("äºŒç»´ç ç”Ÿæˆå¤±è´¥ï¼šæœªåˆ›å»ºcanvaså…ƒç´ "),null;try{return o.toDataURL("image/png")}catch(e){return console.error("Base64è½¬æ¢å¤±è´¥ï¼š",e),null}},b=(e,t,n)=>$('<div class="main-'+e+'"><div class="pop-tool-overlay-bg"></div><div class="card p-2 p-md-4 pop-tool-box '+e+'-box no-animation">'+t+("poster"==e?"":'<div id="'+n+'" class="close-btn"><i class="iconfont icon-guanbi"></i></div>')+"</div></div>"),g=(e,t)=>{0===$(e).length&&$("body").append(t()),requestAnimationFrame(()=>{$(e).addClass("open"),$("body").css("overflow","hidden")})},w=e=>{e.removeClass("open"),$("body").css("overflow",""),setTimeout(function(){e.remove()},500)};$(document).on("click",".close-btn,.pop-close-btn",function(){const e=$(this).closest(".main-poster, .main-reward, .main-share");w(e)}),$(document).click(function(e){const t=$(e.target);!t.closest(".search-box, #search-btn").length&&$(".search-box").is(":visible")&&($(".main-search").removeClass("open"),$("body").css("overflow","")),!t.closest(".poster-box, #poster-btn, .down-btn-box").length&&$(".poster-box").is(":visible")&&w($(".main-poster")),!t.closest(".reward-box, #reward-btn").length&&$(".reward-box").is(":visible")&&w($(".main-reward")),!t.closest(".share-box, #share-btn").length&&$(".share-box").is(":visible")&&w($(".main-share"))}),$(document).click(function(e){e.stopPropagation()});const y=()=>{var e=["æ˜ŸæœŸæ—¥","æ˜ŸæœŸä¸€","æ˜ŸæœŸäºŒ","æ˜ŸæœŸä¸‰","æ˜ŸæœŸå››","æ˜ŸæœŸäº”","æ˜ŸæœŸå…­"],t=new Date,n=t.getDate();const o=n<10?"0"+n:n,s=t.getDay(),i=$("#logo>img").attr("src"),a=$(".author-left>name>a").first().text(),c=$(".post-category > a").first().text();return b("poster",`<div id="posterCapture" class="poster-post-box p-3">\n        <div class="poster-cover"><img src="${decodeURIComponent(_ARTICLE_COVER_URL)}" /></div>\n        <div class="poster-content d-flex flex-row align-items-start mt-4">\n          <div class="poster-date text-center px-2 py-1 flex-shrink-0">\n            <div style="font-size: 1rem;color:red;">${e[s]}</div>\n            <div class="font-weight-bold" style="font-size:1.5rem;">${o}</div>\n          </div>\n          <div class="poster-post-content flex-grow-1">\n            <h5 class="poster-post-title font-weight-bold">${decodeURIComponent(_ARTICLE_NAME)}</h5>\n            <p class="poster-post-text m-0">ä½œè€…ï¼š${a}&nbsp;|&nbsp;åˆ†ç±»ï¼š${c}</p>\n          </div>\n        </div>\n        <div class="poster-footer d-flex flex-row justify-content-between align-items-center p-2 mt-4" style="color:var(--poster-text-color);">\n          <div class="poster-footer-left">\n            <div><img style="width:auto;height:25px;" src="${i}">&nbsp;|&nbsp;æ–‡ç« æµ·æŠ¥</div>\n            <div style="font-size:0.9rem;">æ‰«ç è¯†åˆ«å‰å¾€æŸ¥çœ‹æ›´å¤šå†…å®¹ğŸ‘‰</div>\n          </div>\n          <div class="poster-footer-right flex-shrink-0">\n            <img style="height:50px;" src="${f(decodeURIComponent(_ARTICLE_URL))}">\n          </div>\n        </div>\n      </div>\n      <div class="down-btn-box">\n        <div class="post-tools d-flex justify-content-center">\n          <div class="post-tools-item"><button class="btn" id="poster-download-btn" title="ä¿å­˜æµ·æŠ¥"><i class="iconfont icon-baocun"></i></button></div>\n          <div class="post-tools-item"><button class="btn pop-close-btn" id="poster-close-btn" title="å…³é—­æµ·æŠ¥"><i class="iconfont icon-guanbi"></i></button></div>\n        </div>\n      </div>\n      `,"poster-close-btn")};$("#poster-btn").click(function(){g(".main-poster",y)}),$(document).on("click","#poster-download-btn",function(){htmlToImage.toPng(document.querySelector("#posterCapture")).then(function(e){var t=document.createElement("a");t.download=decodeURIComponent(_ARTICLE_NAME)+"-æµ·æŠ¥å›¾ç‰‡.png",t.href=e,t.click()})});const C=()=>b("reward",'<div class="reward-content d-flex justify-content-center"><div class="reward-qr d-flex flex-column align-items-center"><img src="'+decodeURIComponent(_WXQR)+'" atl="å¾®ä¿¡æ”¯ä»˜" /><span>å¾®ä¿¡</span></div><div class="reward-qr d-flex flex-column align-items-center"><img src="'+decodeURIComponent(_ZFBQR)+'" atl="æ”¯ä»˜å®æ”¯ä»˜" /><span>æ”¯ä»˜å®</span></div></div>',"reward-close-btn");$("#reward-btn").click(function(){g(".main-reward",C)});const x={qq:"http://connect.qq.com/widget/shareqq/index.html?url=",weibo:"http://service.weibo.com/share/share.php?url=",twitter:"https://twitter.com/intent/tweet?url=",wechat:"javascript:void(0);"},R=()=>b("share",'<p class="p-2">'+decodeURIComponent(_ARTICLE_URL)+'</p><div class="share-a d-flex flex-row justify-content-center"><a class="share-item d-flex align-items-center justify-content-center" href="'+x.qq+decodeURIComponent(_ARTICLE_URL)+"&title="+decodeURIComponent(_ARTICLE_NAME)+'" title="QQåˆ†äº«"><i class="iconfont icon-qq"></i></a><a class="share-item d-flex align-items-center justify-content-center" href="'+x.weibo+decodeURIComponent(_ARTICLE_URL)+"&title="+decodeURIComponent(_ARTICLE_NAME)+'" title="å¾®åšåˆ†äº«"><i class="iconfont icon-weibo"></i></a><a class="share-item d-flex align-items-center justify-content-center" href="'+x.twitter+decodeURIComponent(_ARTICLE_URL)+"&text="+decodeURIComponent(_ARTICLE_NAME)+'" title="æ¨ç‰¹åˆ†äº«"><i class="iconfont icon-tuite"></i></a><a id="share-wechat" class="share-item d-flex align-items-center justify-content-center" href="'+x.wechat+'" title="æœ‹å‹åœˆåˆ†äº«"><i class="iconfont icon-pengyouquan"></i></a><a id="share-zdyqr" class="share-item d-flex align-items-center justify-content-center" href="'+x.wechat+'" title="ç”ŸæˆäºŒç»´ç "><i class="iconfont icon-erweima"></i></a></div>',"share-close-btn");$("#share-btn").click(function(){g(".main-share",R)}),a("#share-wechat","wechat-qrcode","å¾®ä¿¡æ‰«ç åˆ†äº«"),a("#share-zdyqr","zdyqr-qrcode","æ‰«ç åˆ†äº«");const I=e=>{const t=$.extend({duration:1500,easing:e=>e*(2-e),format:e=>e.toLocaleString()},e),n=$(t.selector);if(!n.length)return void console.error("å…ƒç´ æœªæ‰¾åˆ°:",t.selector);let o=null;const s=t.end-t.start,i=Math.abs(s)>1e4,a=e=>{o=o||e;const c=e-o,r=Math.min(c/t.duration,1),l=t.easing(r);let d=t.start+s*l;if(i){const e=t.end-d;d=Math.abs(e)>1e3?t.end-e*(1+Math.random()/3):d}n.text(t.format(Math.floor(d))),r<1?requestAnimationFrame(a):n.text(t.format(t.end))};requestAnimationFrame(a)};$("img.lazy,.hh-widget img.widget-lazy").lazyload({effect:"fadeIn",threshold:200,container:window,failure_limit:30});let k=0;const T=$("#navbar"),L=$(".sidebar-sticky"),A=100;if($(window).scroll(function(){const e=$(this).scrollTop();if(e<A)return T.removeClass("nav-hidden").addClass("nav-visible"),void(k=e);Math.abs(e-k)>5&&(e>k?(T.removeClass("nav-visible").addClass("nav-hidden"),L.addClass("visible-top")):(T.removeClass("nav-hidden").addClass("nav-visible"),L.removeClass("visible-top"))),k=e}),c(".nav-menu>.nav-item",.15),c(".hh-widget:not(.no-animation)",.3),c(".card:not(.no-animation)",.3),c(".links-card",.3),"undefined"!=typeof Swiper){var _=new Swiper(".swiper-container",{direction:"horizontal",loop:!0,autoplay:5e3,speed:1e3,autoplayDisableOnInteraction:!1,pagination:".swiper-pagination",paginationClickable:!0,prevButton:".swiper-button-prev",nextButton:".swiper-button-next",roundLengths:!0,parallax:!0,lazyLoading:!0});$(".swiper-container").mouseenter(function(){_.stopAutoplay()}).mouseleave(function(){_.startAutoplay()}),$(".swiper-container").hover(function(){_.stopAutoplay()},function(){_.startAutoplay()})}if("undefined"!=typeof ViewImage&&window.ViewImage&&ViewImage.init(".post-content img[show-img],.comment-list img"),showSvg(),$(".timejourney-progress").length>0){var q=$(".timejourney-progress").data("percentage");const e=q||0;$(".timejourney-progress").css({width:e+"%",transition:"width "+(e/10+1)+"s ease-in-out"}),I({start:0,end:e,duration:e/10*1e3+1500,selector:"#timejourney-progress",format:e=>`${e}%`})}});