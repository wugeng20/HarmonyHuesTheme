$(document).ready(function(){function t(t=l.LIGHT){let o=t;t===l.SYSTEM&&(o=e()),$("html").attr("data-theme",o),n("theme",t,7),n("system_theme",o,1),$("img.logo-light").each(function(){var t=$(this),e=t.attr("src"),n=t.attr("dark-src")||"",s=t.attr("white-src")||"";"light"===o&&s?t.attr("src",s).attr("dark-src",e).removeAttr("white-src"):"dark"===o&&n&&t.attr("src",n).attr("white-src",e).removeAttr("dark-src")})}function e(){return window.matchMedia("(prefers-color-scheme: dark)").matches?l.DARK:l.LIGHT}function n(t,e,n){const o=new Date;o.setTime(o.getTime()+24*n*60*60*1e3),document.cookie=`${t}=${e}; expires=${o.toUTCString()}; path=/`}function o(t){$(".theme-toggle button").removeClass("active"),t.addClass("active")}function s(){const t=i("theme")||l.LIGHT;let e;e=t===l.LIGHT?$('.theme-toggle button[title="æµ…è‰²æ¨¡å¼"]'):t===l.DARK?$('.theme-toggle button[title="æ·±è‰²æ¨¡å¼"]'):t===l.SYSTEM?$('.theme-toggle button[title="è·Ÿéšç³»ç»Ÿ"]'):$('.theme-toggle button[title="æµ…è‰²æ¨¡å¼"]'),o(e)}function i(t){const e=document.cookie.split(";");for(let n of e){const[e,o]=n.trim().split("=");if(e===t)return o}return null}function a(t,e,n){const o="wechat-qrcode"===e?"zdyqr-qrcode":"wechat-qrcode";$(document).on("click",t,function(){const t=$(`.${e}`),s=$(`.${o}`),i=$(".share-box");if(t.length)t.remove();else{s.remove();const t=decodeURIComponent(_ARTICLE_URL),o=`\n        <div class="${e} text-center my-4">\n          <img src="${f(t)}" \n               alt="åˆ†äº«äºŒç»´ç "\n               title="${encodeURIComponent(_ARTICLE_NAME)}">\n          <div class="mt-2">${n}</div>\n        </div>\n      `;i.append(o)}})}function c(t,e){$(t).each(function(t){var n=t*e+"s";$(this).css("animation-delay",n)})}const r=(t,e)=>{let n=null;return function(){n||(n=setTimeout(()=>{t.apply(this,arguments),n=null},e))}};$("#nav-backtop").click(function(){return $("html, body").animate({scrollTop:0},200),!1});const l={LIGHT:"light",DARK:"dark",SYSTEM:"system"};$(".theme-toggle").on("click","button",function(){const e=$(this).attr("title");switch(e){case"æµ…è‰²æ¨¡å¼":t(l.LIGHT);break;case"æ·±è‰²æ¨¡å¼":t(l.DARK);break;case"è·Ÿéšç³»ç»Ÿ":t(l.SYSTEM)}o($(this))}),s(),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",()=>{t(l.SYSTEM)});const d=()=>{const t=$(window).scrollTop(),e=$(document).height(),n=$(window).height(),o=Math.round(t/(e-n)*100);o>0?($("#nav-backtop").toggleClass("top-to-active",o>=90),$(".back-to-top").show(),$("#nav-backtop>.top-to-text").text(o>=90?"å›åˆ°é¡¶éƒ¨":o)):$(".back-to-top").hide()};let m=!1;$("#navbar").hasClass("nav-ui-one")&&(m=!0),toggleNavOnScroll=((t,e,n,o=100)=>{if(m)return;const s=$(t),i=$(this).scrollTop();i>o?s.hasClass(n)&&s.removeClass(n).addClass(e):s.hasClass(e)&&s.removeClass(e).addClass(n)}),d(),toggleNavOnScroll("#navbar","nav-ui-one","nav-ui-two",100),$(window).scroll(function(){r(d(),100),r(toggleNavOnScroll("#navbar","nav-ui-one","nav-ui-two",50),100)});let p=0,v=0,u=!1;$("#menu-line").click(function(t){t.stopPropagation();const e=$("#nav-components");if(e.length)return void h();const n=$("#mobile-nav");n.append('<div id="mobile-nav-bg" class="pop-tool-overlay-bg"></div>');const o=$(".nav-inner > ul").clone();o.find(".sub-menu").addClass("mt-1"),o.find(".sub-menu>ul").addClass("row p-1 ml-2"),o.find(".sub-menu>ul>li").addClass("col-4 p-1"),o.find(".nav-item").addClass("pb-3"),o.find(".nav-item>.nav-a").addClass("font-weight-bold"),o.find(".nav-item>.nav-a").prepend('<i class="iconfont icon-xingqiu font-weight-normal mr-1"></i>'),n.append(`<div id="nav-components" class="mobile-aside px-3 py-2"><div class="mx-auto"><i class="back-box mb-2"></i></div><div id="mobile-close-btn" class="mobile-close-btn m-2"><i class="iconfont icon-guanbi"></i></div>${o.prop("outerHTML")}</div>`),requestAnimationFrame(()=>{$("#mobile-nav-bg").css({opacity:"1",visibility:"visible",transform:"rotate(0) scale(1)"}),$("#nav-components").addClass("open")}),$("body").css("overflow","hidden")}),$(document).click(function(t){!$("#nav-components").hasClass("open")||$(t.target).closest("#nav-components").length||$(t.target).closest("#menu-line").length||h()}),$("#nav-components").click(function(t){t.stopPropagation()}),$(document).on("touchstart",function(t){$("#nav-components").hasClass("open")&&(p=t.originalEvent.touches[0].pageY,v=p,u=!0)}),$(document).on("touchmove",function(t){if(u){v=t.originalEvent.touches[0].pageY;const e=v-p;e>0&&$("#nav-components").css("transform",`translateY(${e}px)`)}}),$(document).on("touchend",function(){if(u){const t=v-p,e=$("#nav-components").height()/2;t>e?h():$("#nav-components").css("transform",""),u=!1}}),$(document).on("click","#mobile-close-btn",function(){h()});const h=()=>{const t=$("#nav-components"),e=$("#mobile-nav-bg");t.removeClass("open"),e.css({opacity:0,visibility:"hidden"}),t.one("transitionend",function(){t.remove(),e.remove(),$("body").css("overflow","")})};$("#search-btn").click(function(){$(".main-search").addClass("open"),$("body").css("overflow","hidden")}),$(".search-box").on("click","#search-close-btn",function(){$(".main-search").removeClass("open"),$("body").css("overflow","")});const f=(t,e=200)=>{const n=document.createElement("div");$(n).qrcode({text:t,width:e,height:e});const o=n.querySelector("canvas");if(!o)return console.error("äºŒç»´ç ç”Ÿæˆå¤±è´¥ï¼šæœªåˆ›å»ºcanvaså…ƒç´ "),null;try{return o.toDataURL("image/png")}catch(t){return console.error("Base64è½¬æ¢å¤±è´¥ï¼š",t),null}},b=(t,e,n)=>$('<div class="main-'+t+'"><div class="pop-tool-overlay-bg"></div><div class="card p-2 p-md-4 pop-tool-box '+t+'-box no-animation">'+e+("poster"==t?"":'<div id="'+n+'" class="close-btn"><i class="iconfont icon-guanbi"></i></div>')+"</div></div>"),g=(t,e)=>{0===$(t).length&&$("body").append(e()),requestAnimationFrame(()=>{$(t).addClass("open"),$("body").css("overflow","hidden")})},w=t=>{t.removeClass("open"),$("body").css("overflow",""),setTimeout(function(){t.remove()},500)};$(document).on("click",".close-btn,.pop-close-btn",function(){const t=$(this).closest(".main-poster, .main-reward, .main-share");w(t)}),$(document).click(function(t){const e=$(t.target);!e.closest(".search-box, #search-btn").length&&$(".search-box").is(":visible")&&($(".main-search").removeClass("open"),$("body").css("overflow","")),!e.closest(".poster-box, #poster-btn, .down-btn-box").length&&$(".poster-box").is(":visible")&&w($(".main-poster")),!e.closest(".reward-box, #reward-btn").length&&$(".reward-box").is(":visible")&&w($(".main-reward")),!e.closest(".share-box, #share-btn").length&&$(".share-box").is(":visible")&&w($(".main-share"))}),$(document).click(function(t){t.stopPropagation()});const y=()=>{var t=["æ˜ŸæœŸæ—¥","æ˜ŸæœŸä¸€","æ˜ŸæœŸäºŒ","æ˜ŸæœŸä¸‰","æ˜ŸæœŸå››","æ˜ŸæœŸäº”","æ˜ŸæœŸå…­"],e=new Date,n=e.getDate();const o=n<10?"0"+n:n,s=e.getDay(),i=$("#logo>img").attr("src"),a=$(".author-left>name>a").first().text(),c=$(".post-category > a").first().text();return b("poster",`<div id="posterCapture" class="poster-post-box p-3">\n        <div class="poster-cover"><img src="${decodeURIComponent(_ARTICLE_COVER_URL)}" /></div>\n        <div class="poster-content d-flex flex-row align-items-start mt-4">\n          <div class="poster-date text-center px-2 py-1 flex-shrink-0">\n            <div style="font-size: 1rem;color:red;">${t[s]}</div>\n            <div class="font-weight-bold" style="font-size:1.5rem;">${o}</div>\n          </div>\n          <div class="poster-post-content flex-grow-1">\n            <h5 class="poster-post-title font-weight-bold">${decodeURIComponent(_ARTICLE_NAME)}</h5>\n            <p class="poster-post-text m-0">ä½œè€…ï¼š${a}&nbsp;|&nbsp;åˆ†ç±»ï¼š${c}</p>\n          </div>\n        </div>\n        <div class="poster-footer d-flex flex-row justify-content-between align-items-center p-2 mt-4" style="color:var(--poster-text-color);">\n          <div class="poster-footer-left">\n            <div><img style="width:auto;height:25px;" src="${i}">&nbsp;|&nbsp;æ–‡ç« æµ·æŠ¥</div>\n            <div style="font-size:0.9rem;">æ‰«ç è¯†åˆ«å‰å¾€æŸ¥çœ‹æ›´å¤šå†…å®¹ğŸ‘‰</div>\n          </div>\n          <div class="poster-footer-right flex-shrink-0">\n            <img style="height:50px;" src="${f(decodeURIComponent(_ARTICLE_URL))}">\n          </div>\n        </div>\n      </div>\n      <div class="down-btn-box">\n        <div class="post-tools d-flex justify-content-center">\n          <div class="post-tools-item"><button class="btn" id="poster-download-btn" title="ä¿å­˜æµ·æŠ¥"><i class="iconfont icon-baocun"></i></button></div>\n          <div class="post-tools-item"><button class="btn pop-close-btn" id="poster-close-btn" title="å…³é—­æµ·æŠ¥"><i class="iconfont icon-guanbi"></i></button></div>\n        </div>\n      </div>\n      `,"poster-close-btn")};$("#poster-btn").click(function(){g(".main-poster",y)}),$(document).on("click","#poster-download-btn",function(){htmlToImage.toPng(document.querySelector("#posterCapture")).then(function(t){var e=document.createElement("a");e.download=decodeURIComponent(_ARTICLE_NAME)+"-æµ·æŠ¥å›¾ç‰‡.png",e.href=t,e.click()})});const C=()=>b("reward",'<div class="reward-content d-flex justify-content-center"><div class="reward-qr d-flex flex-column align-items-center"><img src="'+decodeURIComponent(_WXQR)+'" atl="å¾®ä¿¡æ”¯ä»˜" /><span>å¾®ä¿¡</span></div><div class="reward-qr d-flex flex-column align-items-center"><img src="'+decodeURIComponent(_ZFBQR)+'" atl="æ”¯ä»˜å®æ”¯ä»˜" /><span>æ”¯ä»˜å®</span></div></div>',"reward-close-btn");$("#reward-btn").click(function(){g(".main-reward",C)});const x={qq:"http://connect.qq.com/widget/shareqq/index.html?url=",weibo:"http://service.weibo.com/share/share.php?url=",twitter:"https://twitter.com/intent/tweet?url=",wechat:"javascript:void(0);"},R=()=>b("share",'<p class="p-2">'+decodeURIComponent(_ARTICLE_URL)+'</p><div class="share-a d-flex flex-row justify-content-center"><a class="share-item d-flex align-items-center justify-content-center" href="'+x.qq+decodeURIComponent(_ARTICLE_URL)+"&title="+decodeURIComponent(_ARTICLE_NAME)+'" title="QQåˆ†äº«"><i class="iconfont icon-qq"></i></a><a class="share-item d-flex align-items-center justify-content-center" href="'+x.weibo+decodeURIComponent(_ARTICLE_URL)+"&title="+decodeURIComponent(_ARTICLE_NAME)+'" title="å¾®åšåˆ†äº«"><i class="iconfont icon-weibo"></i></a><a class="share-item d-flex align-items-center justify-content-center" href="'+x.twitter+decodeURIComponent(_ARTICLE_URL)+"&text="+decodeURIComponent(_ARTICLE_NAME)+'" title="æ¨ç‰¹åˆ†äº«"><i class="iconfont icon-tuite"></i></a><a id="share-wechat" class="share-item d-flex align-items-center justify-content-center" href="'+x.wechat+'" title="æœ‹å‹åœˆåˆ†äº«"><i class="iconfont icon-pengyouquan"></i></a><a id="share-zdyqr" class="share-item d-flex align-items-center justify-content-center" href="'+x.wechat+'" title="ç”ŸæˆäºŒç»´ç "><i class="iconfont icon-erweima"></i></a></div>',"share-close-btn");$("#share-btn").click(function(){g(".main-share",R)}),a("#share-wechat","wechat-qrcode","å¾®ä¿¡æ‰«ç åˆ†äº«"),a("#share-zdyqr","zdyqr-qrcode","æ‰«ç åˆ†äº«");const I=t=>{const e=$.extend({duration:1500,easing:t=>t*(2-t),format:t=>t.toLocaleString()},t),n=$(e.selector);if(!n.length)return void console.error("å…ƒç´ æœªæ‰¾åˆ°:",e.selector);let o=null;const s=e.end-e.start,i=Math.abs(s)>1e4,a=t=>{o=o||t;const c=t-o,r=Math.min(c/e.duration,1),l=e.easing(r);let d=e.start+s*l;if(i){const t=e.end-d;d=Math.abs(t)>1e3?e.end-t*(1+Math.random()/3):d}n.text(e.format(Math.floor(d))),r<1?requestAnimationFrame(a):n.text(e.format(e.end))};requestAnimationFrame(a)};$("img.lazy,.hh-widget img.widget-lazy").lazyload({effect:"fadeIn",threshold:200,container:window,failure_limit:30});let k=0;const T=$("#navbar"),A=$(".sidebar-sticky"),L=100;if($(window).scroll(function(){const t=$(this).scrollTop();if(t<L)return T.removeClass("nav-hidden").addClass("nav-visible"),void(k=t);Math.abs(t-k)>5&&(t>k?(T.removeClass("nav-visible").addClass("nav-hidden"),A.addClass("visible-top")):(T.removeClass("nav-hidden").addClass("nav-visible"),A.removeClass("visible-top"))),k=t}),c(".nav-menu>.nav-item",.15),c(".hh-widget:not(.no-animation)",.3),c(".card:not(.no-animation)",.3),c(".links-card",.3),"undefined"!=typeof Swiper){var _=new Swiper(".swiper-container",{direction:"horizontal",loop:!0,autoplay:5e3,speed:1e3,autoplayDisableOnInteraction:!1,pagination:".swiper-pagination",paginationClickable:!0,prevButton:".swiper-button-prev",nextButton:".swiper-button-next",roundLengths:!0,parallax:!0,lazyLoading:!0});$(".swiper-container").mouseenter(function(){_.stopAutoplay()}).mouseleave(function(){_.startAutoplay()}),$(".swiper-container").hover(function(){_.stopAutoplay()},function(){_.startAutoplay()})}if("undefined"!=typeof ViewImage&&window.ViewImage&&ViewImage.init(".post-content img[show-img],.comment-list img"),showSvg(),$(".timejourney-progress").length>0){var q=$(".timejourney-progress").data("percentage");const t=q||0;$(".timejourney-progress").css({width:t+"%",transition:"width "+(t/10+1)+"s ease-in-out"}),I({start:0,end:t,duration:t/10*1e3+1500,selector:"#timejourney-progress",format:t=>`${t}%`})}});